/*! angular-thickm 18-08-2014 */
!function(){"use strict";angular.module("thickm.collection",["thickm.util"]),angular.module("thickm.resource",["thickm.collection","thickm.util"]),angular.module("thickm",["thickm.resource","thickm.collection","thickm.util"]),angular.module("thickm.util",[]),angular.module("thickm.resource").provider("Resource",function(){function a(a){return a.success=function(b){return a.then(function(a){b(a)}),a},a.error=function(b){return a.then(null,function(a){b(a)}),a},a}var b=this;this.setBaseUrl=function(a){this.baseUrl=a},this.headers={post:{"Content-Type":"application/json"},put:{"Content-Type":"application/json"},"delete":{"Content-Type":"application/json"}},this.$get=function(c,d,e){function f(a){angular.extend(this,a)}return f.prototype._resourceName="items",f.prototype._primaryField="id",f._collectionClass=e,f.validate=function(a){return angular.isObject(a)},f.build=function(a){if(!this.validate(a))throw new Error("invalid item "+JSON.stringify(a));return new this(a)},f.prototype.getCollectionUrl=function(){return(b.baseUrl||"/")+this._resourceName},f.prototype.getResourceUrl=function(a){return this.getCollectionUrl()+"/"+(a||this[this._primaryField])},f.transformCollectionResponse=function(a){return this._collectionClass.build(this,a)},f.transformItemResponse=function(a){return this.build(a.data)},f.prototype.transformItemRequest=function(){return this},f.queryUrl=function(b,d){var e=this,f=c.get(b,d?{params:d}:void 0).then(function(a){return e.transformCollectionResponse(a)});return a(f)},f.query=function(a){return this.queryUrl(this.prototype.getCollectionUrl(),a)},f.getUrl=function(b,d){var e=this,f=c.get(b,d?{params:d}:void 0).then(function(a){return e.transformItemResponse(a)});return a(f)},f.get=function(a,b){return this.getUrl(this.prototype.getResourceUrl(a),b)},f.prototype.isNew=function(){return!(this._primaryField in this&&angular.isDefined(this[this._primaryField]))},f.prototype.update=function(a){angular.extend(this,a)},f.prototype.save=function(){var d,e=this,f=this.isNew(),g={};g.headers=angular.copy(f?b.headers.post:b.headers.put);var h=this.transformItemRequest(g.headers);return d=this.isNew()?c.post(this.getCollectionUrl(),h,g):c.put(this.getResourceUrl(),h,g),d.then(function(a){e.update(a.data)}),a(d)},f.prototype.delete=function(){if(this.isNew()){var e=d.defer();return e.resolve({}),a(e.promise)}var f={};return f.headers=angular.copy(b.headers.delete),this.transformItemRequest(f.headers),a(c.delete(this.getResourceUrl(),f))},f}}),angular.module("thickm.collection").factory("ResourceCollection",function(a){function b(){Array.apply(this,arguments)}return a.extend(b,Array),b._itemsField=null,b._metaField="meta",b.itemsFromResponse=function(a,b){var c=this._itemsField?b.data[this._itemsField]:b.data;return c.map(function(b){return a.build(b)})},b.metaFromResponse=function(a,b){return this._metaField?b.data[this._metaField]:{}},b.build=function(a,b){var c=new this;c._resourceClass=a;var d=this.itemsFromResponse(a,b);return angular.forEach(d,function(a){c.push(a)}),c._meta=this.metaFromResponse(a,b),c},b}),angular.module("thickm.util").factory("ThickmUtil",function(){function a(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}return{extend:a}})}(window,document);