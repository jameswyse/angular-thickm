/*! angular-thickm 12-08-2014 */
!function(){"use strict";angular.module("thickm.collection",["thickm.util"]),angular.module("thickm.resource",["thickm.collection","thickm.util"]),angular.module("thickm",["thickm.resource","thickm.collection","thickm.util"]),angular.module("thickm.util",[]),angular.module("thickm.resource").provider("resourceFactory",function(){function a(a){return a.success=function(b){return a.then(function(a){b(a)}),a},a.error=function(b){return a.then(null,function(a){b(a)}),a},a}var b=this;this.setBaseUrl=function(a){this.baseUrl=a},this.headers={post:{"Content-Type":"application/json"},put:{"Content-Type":"application/json"}},this.$get=function(c,d,e){function f(){function f(){}return f.prototype._resourceName="item",f.prototype._primaryField="id",f.prototype._collectionClass=e,f.validate=function(){return!0},f.build=function(a){if(!this.validate(a))throw new Error("invalid item "+JSON.stringify(a));return new this(a)},f.prototype.getResourceUrl=function(){return b.baseUrl+this._resourceName},f.transformCollectionResponse=function(a){return this._collectionClass.build(this,a)},f.transformItemResponse=function(a){return this.build(a.data)},f.prototype.transformItemRequest=function(){return this},f.query=function(b){var d=this,e=c.get(this.prototype.getResourceUrl(),{params:b?b:null}).then(function(a){return d.transformCollectionResponse(a)});return a(e)},f.get=function(b,d){var e=this,f=c.get(this.prototype.getResourceUrl()+"/"+b,{params:d?d:null}).then(function(a){return e.transformItemResponse(a)});return a(f)},f.prototype.isNew=function(){return!(this._primaryField in this&&angular.isDefined(this[this._primaryField]))},f.prototype.update=function(a){angular.extend(this,a)},f.prototype.save=function(){var d,e,f=this,g=this.transformItemRequest();return this.isNew()?(e={headers:b.headers.post},d=c.post(this.getResourceUrl(),g,e)):(e={headers:b.headers.put},d=c.put(this.getResourceUrl()+"/"+this[this._primaryField],g,e)),d.then(function(a){f.update(a.data)}),a(d)},f.prototype.delete=function(){if(this.isNew()){var b=d.defer();return b.resolve({}),a(b.promise)}return c.delete(this.getResourceUrl()+"/"+this[this._primaryField])},f}return f.baseUrl=b.baseUrl,f}}),angular.module("thickm.collection").factory("ResourceCollection",function(a){function b(){Array.apply(this,arguments)}return a.extend(b,Array),b._itemsField=null,b._metaField="meta",b.itemsFromResponse=function(a,b){var c=this._itemsField?b.data[this._itemsField]:b.data;return c.map(function(b){return a.build(b)})},b.metaFromResponse=function(a,b){return this._metaField?b.data[this._metaField]:{}},b.prototype.query=function(a){return this.resourceClass.query(a)},b.build=function(a,b){var c=new this;c._resourceClass=a;var d=this.itemsFromResponse(a,b);return angular.forEach(d,function(a){c.push(a)}),c._meta=this.metaFromResponse(a,b),c},b.collectionInit=function(c){a.extend(c,b),angular.extend(c,b)},b}),angular.module("thickm.util").factory("ThickmUtil",function(){function a(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}return{extend:a}})}(window,document);